@{
    ViewData["Title"] = "Member Dashboard";
    var userName = "Sarah"; // Replace with actual user data
    var profileImage = "/images/client-img.png"; // Use correct path for wwwroot
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    background: linear-gradient(135deg, #f0fdfa 0%, #e0e7ff 100%);
    min-height: 100vh;
}
@@media (max-width: 991.98px) {
    body { background: #e0e7ff; }
    .sidebar { display: none !important; }
    main { margin-left: 0 !important; }
}
.glass {
    background: rgba(255,255,255,0.7);
    box-shadow: 0 8px 32px 0 rgba(31,38,135,0.18);
    backdrop-filter: blur(8px);
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,0.18);
}
.sidebar {
    min-height: 100vh;
    background: rgba(255,255,255,0.6);
    border-right: 1px solid #e5e7eb;
    padding: 2rem 1rem 1rem 1rem;
    position: fixed;
    left: 0;
    top: 0;
    width: 220px;
    z-index: 100;
}
.profile-section {
    margin-bottom: 2rem;
}
.profile-img {
    width: 70px;
    height: 70px;
    object-fit: cover;
    border-radius: 50%;
    border: 3px solid #6366f1;
    box-shadow: 0 2px 8px rgba(99,102,241,0.1);
}
.sidebar a {
    display: block;
    color: #6366f1;
    font-weight: 500;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    margin-bottom: 0.5rem;
    text-decoration: none;
    transition: background 0.2s, color 0.2s;
}
.sidebar a.active, .sidebar a:hover {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    color: #fff;
}
.toggle-dark {
    cursor: pointer;
    color: #6366f1;
    font-weight: 600;
}
.dashboard-header {
    margin-top: 2rem;
}
.modern-btn {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    color: #fff !important;
    border: none;
    border-radius: 12px;
    padding: 0.5rem 1.5rem;
    font-weight: 600;
    transition: box-shadow 0.2s, transform 0.2s;
    box-shadow: 0 2px 8px rgba(99,102,241,0.1);
}
.modern-btn:hover {
    box-shadow: 0 8px 24px rgba(99,102,241,0.2);
    transform: translateY(-2px);
}
.quick-stats .card {
    border: none;
    border-radius: 18px;
    margin-bottom: 1rem;
    background: rgba(99,102,241,0.08);
}
.quick-stats i {
    font-size: 2rem;
    color: #6366f1;
}
.profile-card {
    background: rgba(255,255,255,0.8);
    border-radius: 18px;
    box-shadow: 0 2px 8px rgba(99,102,241,0.08);
    padding: 1.5rem;
}
.table.modern-table th, .table.modern-table td {
    vertical-align: middle;
    font-size: 1rem;
}
.table.modern-table th {
    background: #f3f4f6;
    color: #6366f1;
    border-top: none;
}
.table.modern-table tr {
    transition: background 0.2s;
}
.table.modern-table tr:hover {
    background: #f0fdfa;
}
.dark-mode {
    background: #18181b !important;
    color: #f3f4f6 !important;
}
.dark-mode .glass, .dark-mode .profile-card, .dark-mode .card {
    background: rgba(36,37,46,0.85) !important;
    color: #f3f4f6 !important;
}
.dark-mode .sidebar {
    background: rgba(36,37,46,0.85) !important;
    border-right: 1px solid #27272a;
}
.dark-mode .sidebar a {
    color: #a5b4fc;
}
.dark-mode .sidebar a.active, .dark-mode .sidebar a:hover {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    color: #fff;
}
</style>

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-2 d-none d-md-block sidebar glass">
            <div class="profile-section text-center">
                <img src="@profileImage" class="profile-img mb-2" alt="Profile" />
                <div class="fw-bold fs-5">@userName</div>
                <div class="text-warning small mb-2">Member</div>
            </div>
            <a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a>
            <a href="/Member/SearchBook"><i class="fas fa-search"></i> Search Books</a>
            <a href="/Member/MyBorrowing"><i class="fas fa-book"></i> My Borrowing</a>
            <a href="#"><i class="fas fa-clipboard-list"></i> My Requests</a>
            <a href="#"><i class="fas fa-history"></i> History</a>
            <a href="/Member/Profile"><i class="fas fa-user"></i> Profile</a>
            <a href="#" class="toggle-dark mt-4"><i class="fas fa-moon"></i> Dark Mode</a>
        </nav>

        <!-- Main Content -->
        <main class="col-md-10 ms-sm-auto px-4" style="margin-left:220px;">
            <!-- Header -->
            <div class="dashboard-header d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2>Welcome, @userName!</h2>
                    <div class="fs-5">Explore your digital library dashboard</div>
                </div>
                <div>
                    <span class="me-3"><i class="fas fa-bell"></i> <span class="badge bg-warning">2</span></span>
                    <form id="logoutForm" method="post" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home")" style="display:inline;">
                        <button type="submit" class="modern-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
                    </form>
                </div>
            </div>

            <!-- Quick Stats Cards -->
            <div class="row quick-stats mb-4">
                <div class="col-md-3">
                    <div class="card glass text-center">
                        <div class="card-body">
                            <i class="fas fa-book mb-2"></i>
                            <h5>Currently Borrowed</h5>
                            <h3>3</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card glass text-center">
                        <div class="card-body">
                            <i class="fas fa-check-circle mb-2"></i>
                            <h5>Past Borrowings</h5>
                            <h3>12</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card glass text-center">
                        <div class="card-body">
                            <i class="fas fa-money-bill-wave mb-2"></i>
                            <h5>Outstanding Fines</h5>
                            <h3>20 BDT</h3>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card glass text-center">
                        <div class="card-body">
                            <i class="fas fa-clipboard-list mb-2"></i>
                            <h5>Active Requests</h5>
                            <h3>1</h3>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Card -->
            <div class="profile-card mb-4 d-flex align-items-center">
                <img src="@profileImage" class="profile-img me-4" alt="Profile" />
                <div>
                    <h4>@userName</h4>
                    <div class="text-muted">sarah@email.com</div>
                    <div class="mt-2">
                        <span class="badge bg-primary">Active Member</span>
                        <span class="badge bg-success">No Fines</span>
                    </div>
                </div>
            </div>

            <!-- Current Borrowings Table -->
            <div class="card glass">
                <div class="card-header"><i class="fas fa-book"></i> Current Borrowings</div>
                <div class="card-body p-0">
                    <table class="table modern-table mb-0">
                        <thead>
                            <tr>
                                <th>Book Title</th>
                                <th>Borrow Date</th>
                                <th>Due Date</th>
                                <th>Status</th>
                                <th>Fine</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-danger">
                                <td>Digital Design</td>
                                <td>2025-07-01</td>
                                <td>2025-07-10</td>
                                <td>Overdue</td>
                                <td>20 BDT</td>
                            </tr>
                            <tr>
                                <td>C# Programming</td>
                                <td>2025-07-05</td>
                                <td>2025-07-15</td>
                                <td>On Time</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Borrow History Table -->
            <div class="card glass mt-4">
                <div class="card-header"><i class="fas fa-history"></i> Borrow History</div>
                <div class="card-body p-0">
                    <table class="table modern-table mb-0">
                        <thead>
                            <tr>
                                <th>Book Title</th>
                                <th>Borrow Date</th>
                                <th>Return Date</th>
                                <th>Fine Paid</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Data Structures</td>
                                <td>2025-06-01</td>
                                <td>2025-06-10</td>
                                <td>10 BDT</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Active Book Requests Table -->
            <div class="card glass mt-4">
                <div class="card-header"><i class="fas fa-clipboard-list"></i> Active Book Requests</div>
                <div class="card-body p-0">
                    <table class="table modern-table mb-0">
                        <thead>
                            <tr>
                                <th>Book Title</th>
                                <th>Request Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>AI Basics</td>
                                <td>2025-07-02</td>
                                <td>Pending</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Book Search and Request -->
            <div class="card glass mt-4">
                <div class="card-header"><i class="fas fa-search"></i> Search and Request Books</div>
                <div class="card-body">
                    <form class="row g-3 mb-3">
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="Search by title, author, or category" />
                        </div>
                        <div class="col-md-2">
                            <select class="form-select">
                                <option>Available Now</option>
                                <option>By Category</option>
                                <option>By Author</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button class="modern-btn w-100" type="submit"><i class="fas fa-search"></i> Search</button>
                        </div>
                    </form>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card glass">
                                <img src="/images/banner-img.png" class="card-img-top" alt="Book" />
                                <div class="card-body">
                                    <h6 class="card-title">AI Basics</h6>
                                    <p class="card-text">By John Doe</p>
                                    <button class="modern-btn w-100">Request to Borrow</button>
                                </div>
                            </div>
                        </div>
                        <!-- More book cards as needed -->
                    </div>
                </div>
            </div>

            <!-- Notifications Section -->
            <div class="card glass mt-4">
                <div class="card-header"><i class="fas fa-bell"></i> Notifications</div>
                <div class="card-body">
                    <div class="alert alert-success mb-2" role="alert">
                        <i class="fas fa-check-circle"></i> Your request for "AI Basics" was approved!
                    </div>
                    <div class="alert alert-danger mb-0" role="alert">
                        <i class="fas fa-exclamation-triangle"></i> "Digital Design" is overdue. Please return it to avoid fines.
                    </div>
                </div>
            </div>

            <!-- Borrow History Chart -->
            <div class="card glass mb-5 mt-4">
                <div class="card-header"><i class="fas fa-chart-bar"></i> Borrow History Chart</div>
                <div class="card-body">
                    <canvas id="borrowHistoryChart" height="100"></canvas>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
    // Dark mode toggle
    document.querySelector('.toggle-dark').addEventListener('click', function () {
        document.body.classList.toggle('dark-mode');
    });
    // Chart.js example
    var ctx = document.getElementById('borrowHistoryChart').getContext('2d');
    var borrowHistoryChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                label: 'Books Borrowed',
                data: [2, 4, 3, 5, 2, 6],
                backgroundColor: 'rgba(99,102,241,0.7)'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
    // Redirect to home after logout
    document.getElementById('logoutForm').addEventListener('submit', function (e) {
        setTimeout(function () {
            window.location.href = '/';
        }, 100);
    });
</script> 